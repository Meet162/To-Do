{% extends "base.html" %}

{% block content %}
<h1>To-Do List</h1>
<form action="{{ url_for('add') }}" method="POST">
    <input type="text" name="task" placeholder="Enter a new task">
    <select name="person">
        <option value="">Assign to...</option>
        {% for person in people %}
        <option value="{{ person }}">{{ person }}</option>
        {% endfor %}
    </select>
    <button type="submit">Add</button>
</form>
<ul>
    {% for task in tasks %}
    <li>
        {% if task.completed %}
        <s>{{ task.description }} - {{ task.person }}</s>
        {% else %}
        {{ task.description }} - {{ task.person }}
        {% endif %}
        <form action="{{ url_for('complete', task_id=loop.index0) }}" method="POST" style="display: inline;">
            <button type="submit">Complete</button>
        </form>
        <form action="{{ url_for('edit', task_id=loop.index0) }}" method="GET" style="display: inline;">
            <button type="submit">Edit</button>
        </form>
        <form action="{{ url_for('delete', task_id=loop.index0) }}" method="POST" style="display: inline;">
            <button type="submit">Delete</button>
        </form>
    </li>
    {% endfor %}
</ul>
<form action="{{ url_for('clear_completed') }}" method="POST">
    <button type="submit">Clear Completed Tasks</button>
</form>
<h2>People</h2>
<ul>
    {% for person in people %}
    <li>
        <a href="{{ url_for('person_tasks', person_name=person) }}">{{ person }}</a>
    </li>
    {% endfor %}
</ul>
<h2>Visitor Count: {{ visitor_count }}</h2>
{% endblock %}